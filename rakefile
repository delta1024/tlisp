BUILD = "build"

file "#{BUILD}" => [] do 
  sh "meson setup #{BUILD}"
end

task :reconfigure  do 
  sh "meson setup #{BUILD} --reconfigure"
end

task compile: "#{BUILD}" do
  sh "meson compile -C #{BUILD}"
end

task dev: "#{BUILD}" do
  sh "ln -sf #{BUILD}/compile_commands.json ."
end

task :clean do 
  sh "rm -rf #{BUILD}"
  sh "rm compile_commands.json"
end

task run: :compile do
  sh "./build/src/bin/tlisp"
end

task default: :compile
